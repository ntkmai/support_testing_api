{
  "requests": [
    {
      "name": "Login - Người tạo phiếu",
      "method": "POST",
      "endpoint": "/api/auth/login",
      "description": "## BƯỚC 0: Đăng nhập để tạo phiếu\nUser: 55555/55555",
      "headers": {
        "Content-Type": "application/json"
      },
      "body": {
        "username": "55555",
        "password": "55555"
      }
    },
    {
      "name": "BƯỚC 0: Tạo phiếu - LỌ TÀI SẢN",
      "method": "POST",
      "endpoint": "/api/payment-request",
      "description": "## Tạo phiếu đề nghị thanh toán - LỌ TÀI SẢN\n\n**jar_id**: a9656a3d-c43a-4fe9-8fe6-bcfc060de6cd\n**type_document_id**: 7835a8dc-707a-45d0-a006-4cbb9002c568\n\n**TEST Tính tiền**: 2 x 15,000,000 x 1.1 = 33,000,000",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": {
        "date": "2025-12-16",
        "has_advance": false,
        "requester_id": "3d9caa7b-52f0-e711-10da-00155d0a0504",
        "workplace_type": 1,
        "workplace_id": "e92cf911-b543-4638-b996-2c4441ca0480",
        "jar_id": "a9656a3d-c43a-4fe9-8fe6-bcfc060de6cd",
        "content": "LỌ TÀI SẢN - Mua máy tính",
        "payment_type": "cash",
        "payment_details": [
          {
            "description": "Laptop Dell - 2 x 15,000,000 x 1.1 = 33,000,000",
            "unit_id": "4ccc730d-3dd2-441a-b6b6-0eff23d9c16b",
            "quantity": 2,
            "price": 15000000,
            "tax": 10,
            "amount": 33000000
          }
        ],
        "payment_documents": [
          {
            "type_document_id": "7835a8dc-707a-45d0-a006-4cbb9002c568",
            "ref_id": ["11111111-1111-1111-1111-111111111111"],
            "ref_code": ["REF-TS001"]
          }
        ],
        "file_ids": ["e41e24c6-215e-43d5-83bf-94cba481daa2"]
      }
    },
    {
      "name": "Lấy chi tiết phiếu",
      "method": "GET",
      "endpoint": "/api/payment-request/detail/{id}",
      "description": "## Xem chi tiết và lấy payment_documents IDs",
      "headers": {
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      }
    },
    {
      "name": "Login - Trưởng bộ phận",
      "method": "POST",
      "endpoint": "/api/auth/login",
      "description": "## Đăng nhập Trưởng BP\nUser: 55555/55555",
      "headers": {
        "Content-Type": "application/json"
      },
      "body": {
        "username": "55555",
        "password": "55555"
      }
    },
    {
      "name": "BƯỚC 1: Trưởng bộ phận duyệt",
      "method": "PUT",
      "endpoint": "/api/payment-request/status/{id}",
      "description": "## BƯỚC 1: Trưởng bộ phận duyệt\nUser: 55555/55555",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": {
        "status": "approved"
      }
    },
    {
      "name": "Login - Kế toán Tài sản",
      "method": "POST",
      "endpoint": "/api/auth/login",
      "description": "## Đăng nhập KT Tài sản\nUser: 0025/0001",
      "headers": {
        "Content-Type": "application/json"
      },
      "body": {
        "username": "0025",
        "password": "0001"
      }
    },
    {
      "name": "BƯỚC 2: KT Tài sản - Sửa chứng từ đính kèm",
      "method": "PUT",
      "endpoint": "/api/payment-request/documents/{id}",
      "description": "## BƯỚC 2A: KT Tài sản sửa chứng từ\n\n**CHÚ Ý**: Thay ids bằng ID thực tế từ payment_documents",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": [
        {
          "ids": ["REPLACE_WITH_ACTUAL_PAYMENT_DOCUMENT_ID"],
          "type_document_id": "7835a8dc-707a-45d0-a006-4cbb9002c568",
          "ref_id": [
            "11111111-1111-1111-1111-111111111111",
            "22222222-2222-2222-2222-222222222222",
            "33333333-3333-3333-3333-333333333333"
          ],
          "ref_code": ["REF001", "REF002", "REF003"]
        }
      ]
    },
    {
      "name": "BƯỚC 2: KT Tài sản - Duyệt",
      "method": "PUT",
      "endpoint": "/api/payment-request/status/{id}",
      "description": "## BƯỚC 2B: KT Tài sản duyệt",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": {
        "status": "approved"
      }
    },
    {
      "name": "Login - Kế toán Thuế",
      "method": "POST",
      "endpoint": "/api/auth/login",
      "description": "## Đăng nhập KT Thuế\nUser: 44444/44444",
      "headers": {
        "Content-Type": "application/json"
      },
      "body": {
        "username": "44444",
        "password": "44444"
      }
    },
    {
      "name": "BƯỚC 3: KT Thuế - Tạo hóa đơn",
      "method": "PUT",
      "endpoint": "/api/payment-request/invoices/{id}",
      "description": "## BƯỚC 3A: KT Thuế tạo hóa đơn",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": [
        {
          "code": "HD-TS-001",
          "date": "2025-12-16",
          "company_id": "9e2ba481-7040-404a-9da0-d612d28303f5",
          "file_id": "e41e24c6-215e-43d5-83bf-94cba481daa2",
          "place": "Công ty VTCODE",
          "amount": "33000000"
        }
      ]
    },
    {
      "name": "BƯỚC 3: KT Thuế - Tạo hợp đồng",
      "method": "PUT",
      "endpoint": "/api/payment-request/contracts/{id}",
      "description": "## BƯỚC 3B: KT Thuế tạo hợp đồng (tùy chọn)",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": [
        {
          "code": "HĐ-TS-001",
          "date": "2025-12-01",
          "company_id": "9e2ba481-7040-404a-9da0-d612d28303f5",
          "file_id": "46077b44-248a-4dc6-8bcd-4e5594adb92f",
          "place": "Trụ sở chính",
          "amount": "50000000"
        }
      ]
    },
    {
      "name": "BƯỚC 3: KT Thuế - Duyệt",
      "method": "PUT",
      "endpoint": "/api/payment-request/status/{id}",
      "description": "## BƯỚC 3C: KT Thuế duyệt",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": {
        "status": "approved"
      }
    },
    {
      "name": "Login - Kế toán Thanh toán",
      "method": "POST",
      "endpoint": "/api/auth/login",
      "description": "## Đăng nhập KT Thanh toán\nUser: 11111/11111",
      "headers": {
        "Content-Type": "application/json"
      },
      "body": {
        "username": "11111",
        "password": "11111"
      }
    },
    {
      "name": "BƯỚC 4: KT Thanh toán - Tạo hạch toán",
      "method": "POST",
      "endpoint": "/api/payment-request/{id}/accounting",
      "description": "## BƯỚC 4A: KT Thanh toán TẠO HẠCH TOÁN (BẮT BUỘC)\n\n**jar_category_id**: 69f31527-ba0d-499e-838d-f775c3f37690 (Lọ tài sản)",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": {
        "jar_category_id": "69f31527-ba0d-499e-838d-f775c3f37690",
        "items": [
          {
            "debit_account_id": "4ffd48e4-2f4f-4a6c-9687-300b7eb9b482",
            "credit_account_id": "ddb52d80-84d9-47bf-aecc-a13578d1741c",
            "debit_disburser_type": "bank_account",
            "credit_disburser_type": "bank_account",
            "debit_disburser_id": "74eb3886-f8eb-4e92-963a-3c6efaf54cf4",
            "credit_disburser_id": "8c367d7a-229e-4a8d-918e-c1975650e160",
            "unit_id": "4ccc730d-3dd2-441a-b6b6-0eff23d9c16b",
            "quantity": 2,
            "price": 15000000,
            "tax": 10,
            "description": "Mua laptop Dell - 2 x 15M x 1.1 = 33M",
            "expense_code": "BTRIIT"
          }
        ]
      }
    },
    {
      "name": "BƯỚC 4: KT Thanh toán - Duyệt",
      "method": "PUT",
      "endpoint": "/api/payment-request/status/{id}",
      "description": "## BƯỚC 4B: KT Thanh toán duyệt",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": {
        "status": "approved"
      }
    },
    {
      "name": "Login - TBP KTTT",
      "method": "POST",
      "endpoint": "/api/auth/login",
      "description": "## Đăng nhập TBP KTTT\nUser: 22222/22222",
      "headers": {
        "Content-Type": "application/json"
      },
      "body": {
        "username": "22222",
        "password": "22222"
      }
    },
    {
      "name": "BƯỚC 5: TBP KTTT - Duyệt",
      "method": "PUT",
      "endpoint": "/api/payment-request/status/{id}",
      "description": "## BƯỚC 5: TBP KTTT duyệt",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": {
        "status": "approved"
      }
    },
    {
      "name": "Login - Kế toán trưởng",
      "method": "POST",
      "endpoint": "/api/auth/login",
      "description": "## Đăng nhập KT Trưởng\nUser: 33333/33333",
      "headers": {
        "Content-Type": "application/json"
      },
      "body": {
        "username": "33333",
        "password": "33333"
      }
    },
    {
      "name": "BƯỚC 6: Kế toán trưởng - Duyệt CUỐI CÙNG",
      "method": "PUT",
      "endpoint": "/api/payment-request/status/{id}",
      "description": "## BƯỚC 6: Kế toán trưởng duyệt CUỐI CÙNG\n\n**KẾT QUẢ**: Phiếu hoàn tất, tự động tạo lịch chi",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      },
      "body": {
        "status": "approved",
        "disbursement_date": "2025-12-20"
      }
    },
    {
      "name": "Verify - In phiếu PDF",
      "method": "GET",
      "endpoint": "/api/payment-request/print/{id}",
      "description": "## Kiểm tra kết quả - In phiếu PDF",
      "headers": {
        "Authorization": "Bearer YOUR_TOKEN_HERE"
      }
    }
  ],
  "baseUrl": "http://localhost:3000",
  "metadata": {
    "name": "Payment Request - LỌ TÀI SẢN",
    "version": "1.0.0",
    "description": "Test luồng phê duyệt cho LỌ TÀI SẢN",
    "jar_info": {
      "jar_id": "a9656a3d-c43a-4fe9-8fe6-bcfc060de6cd",
      "jar_type": "Lọ Tài sản",
      "type_document_id": "7835a8dc-707a-45d0-a006-4cbb9002c568",
      "jar_category_id": "69f31527-ba0d-499e-838d-f775c3f37690"
    },
    "workflow": "BP → KT Tài sản → KT Thuế → KT Thanh toán → TBP KTTT → KT Trưởng (6 bước)",
    "created": "2025-12-16"
  }
}
